<!-- templates/speech_prompt.html -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Speech Prompt Studio</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="page">
    <div class="card">
        <h1 class="title">Speech Prompt</h1>

        <form id="uploadForm" method="post" enctype="multipart/form-data">
            <label class="label">Upload audio
                <input type="file" name="audio_file" accept="audio/*">
            </label>

            <label class="label">Prompt
                <input type="text" name="prompt" class="input" required>
            </label>

            <div class="radio-row">
                <span>Output type</span>
                <label><input type="radio" name="output_type" value="asr" checked> ASR</label>
                <label><input type="radio" name="output_type" value="classification"> Classification</label>
                <label><input type="radio" name="output_type" value="generation"> Generation</label>
            </div>

            <div class="button-row">
                <button type="submit" class="btn primary">Submit</button>

                <!-- Live recording controls -->
                <button type="button" id="startRec" class="btn ghost">Start Mic</button>
                <button type="button" id="stopRec" class="btn ghost" disabled>Stop</button>
            </div>

            <!-- hidden field to send live recording blob name -->
            <input type="hidden" name="live_filename" id="liveFilename">
        </form>
    </div>

    <div class="card slide-up">
        <h2 class="subtitle">Speech Prompt Result</h2>

        <div class="result-row">
            <div class="result-text">
                {{ result_text if result_text else 'No result yet. Submit or record.' }}
            </div>

            <div class="result-audio">
                {% if audio_filename %}
                    <p>Audio preview</p>
                    <audio controls>
                        <source src="{{ url_for('download_file', filename=audio_filename) }}" type="audio/webm">
                    </audio>
                    <a class="btn small" href="{{ url_for('download_file', filename=audio_filename) }}">Download</a>
                {% else %}
                    <p>No audio available.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='recorder.js') }}"></script>
</body>
</html>
